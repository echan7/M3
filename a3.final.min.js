!function(t,e){"use strict";if("object"==typeof exports)module.exports=e(require("d3"),require("crossfilter"));else if("function"==typeof define&&define.amd)define(["d3"],["crossfilter"],function(o,r){return t.a3=e(o,r),t.a3});else if(t.d3&&t.crossfilter)t.a3=e(t.d3,t.crossfilter);else if(console&&console.warn)t.d3?t.crossfilter||console.warn("a3 requires crossfilter to run. Are you missing a reference to crossfilter library?"):console.warn("a3 requires d3 to run.  Are you missing a reference to the d3 library?");else{if(!t.d3)throw"a3 requires d3 to run.  Are you missing a reference to the d3 library?";if(!t.crossfilter)throw"a3 requires crossfilter to run. Are you missing a reference to crossfilter library?"}}(this,function(t,e){"use strict";var o={version:"1.0.2",plot:{}};return o.plot.setUp=function(e){function o(t,e){return!0!==t||0==e?0:Math.floor(Math.random()*e)-e/2}function r(t,e,o){i(t,e,o);var r={height:y.objs.legend.node().getBBox().height,width:y.objs.legend.node().getBBox().width};return y.objs.legend&&(y.objs.legend.selectAll("g").remove(),y.objs.legend.selectAll("text").remove()),y.objs.legend.remove(),r}function s(t,e,o,r){y.width-=e.width+22,y.xScale.range([0,y.width]),y.objs.xAxis.scale(y.xScale),y.objs.axes.xAxis.call(y.objs.xAxis),y.objs.g.select(".x.axis .label").attr("x",y.width/2),y.objs.g.select(".x.axis .caption").attr("x",y.width/2),y.objs.yAxis.tickSizeInner(-y.width),y.objs.axes.yAxis.call(y.objs.yAxis),i(t,o,r)}function i(t,e,o){y.objs.legend=y.objs.g.append("g").attr("class","legend-wrapper"),y.objs.legend.append("text").attr("class","legend-title").attr("x",y.width+4).attr("y",0).text(o.toUpperCase());var r=y.objs.legend.selectAll(".legend").data(g(e.domain())).enter().append("g").attr("class","legend-point").attr("transform",function(t,e){return"translate("+(y.width+4)+","+(22*e+5)+")"});r.append("rect").attr("class",t+"-legend").attr("width",18).attr("height",18).style("fill",e).style("stroke",e),r.append("text").attr("x",22).attr("y",14).style("fill","black").text(function(t){return t})}function a(e){var o={max:null,upperOuterFence:null,upperInnerFence:null,quartile3:null,median:null,mean:null,quartile1:null,iqr:null,lowerInnerFence:null,lowerOuterFence:null,min:null};o.max=t.max(e),o.quartile3=t.quantile(e,.75),o.median=t.median(e),o.mean=t.mean(e),o.quartile1=t.quantile(e,.25),o.iqr=o.quartile3-o.quartile1,o.min=t.min(e);for(var r=o.quartile1-1.5*o.iqr,s=o.quartile3+1.5*o.iqr,i=0;i<e.length;i++)if(!(e[i]<r))if(!o.lowerInnerFence&&e[i]>=r)o.lowerInnerFence=e[i];else if(e[i]>s){o.upperInnerFence=e[i-1];break}return o.lowerOuterFence=o.quartile1-3*o.iqr,o.upperOuterFence=o.quartile3+3*o.iqr,o.lowerInnerFence||(o.lowerInnerFence=o.min),o.upperInnerFence||(o.upperInnerFence=o.max),o}function l(t){if(null==t||"object"!=typeof t)return t;var e=t.constructor();for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function n(e){return e%1!=0?t.format(".2f")(e):t.format(".0f")(e)}function c(e){if("function"==typeof e)return e;if(Array.isArray(e)){var o={},r=0;for(var s in y.groupObjs)o[s]=e[r],r=(r+1)%e.length;return function(t){return o[t]}}return"object"==typeof e?function(t){return e[t]}:t.scaleOrdinal(t.schemeCategory10)}function b(t,e,o){var r={left:null,right:null,middle:null},s=t.bandwidth()*(e/100),i=(t.bandwidth()-s)/2,a=t(o);return r.middle=t.bandwidth()/2+a,r.left=i+a,r.right=r.left+s,r}function u(t){var e=Math.log(t)/Math.log(10)+1e-6;return Math.abs(e-Math.floor(e))<.6?n(t):""}function x(t){for(var e=[],o=Object.keys(t),r=0;r<o.length;r++){var s;s="string"==typeof t[o[r]]?"number"!=typeof parseFloat(t[o[r]])||isNaN(parseFloat(t[o[r]]))||parseFloat(t[o[r]]).toString().length!=t[o[r]].length?t[o[r]]:n(parseFloat(t[o[r]])):"number"==typeof t[o[r]]?n(t[o[r]]):t[o[r]],e.push(o[r].charAt(0).toUpperCase()+o[r].slice(1)+": "+s)}return e}function g(e){var o=!1;for(var r in e){if("number"!=typeof parseFloat(e[r])||isNaN(parseFloat(e[r]))||parseFloat(e[r]).toString().length!=e[r].toString().length){o=!1;break}o=!0}if(o)return e.sort(t.ascending);var s=e.slice().reduce(function(t,e){return t.length>e.length?t:e});for(var r in e){var i=Array(s.length+1).join(" ");e[r]=(i+e[r]).slice(-s.length)}return e.sort(t.ascending),e=e.map(function(t){return t.replace(/(^\s+|\s+$)/g,"")})}function p(e,o,r,s){var i={},a=j(y.objs.axes.xAxis.attr("transform"));i.y=a[1],i.x=0,y.objs.tooltip.append("line").attr("class","circle-tooltipline").attr("x1",e).attr("y1",o<i.y?o+r+5+2:o-r-5-2).attr("x2",e).attr("y2",o<i.y?o+r+5+2:o-r-5-2).call(function(t){t.style("fill","none").style("stroke",s).style("stroke-width",2).style("stroke-dasharray","3,3")}).transition().delay(350).duration(350).ease(t.easeLinear).attr("y2",i.y),y.objs.tooltip.append("line").attr("class","circle-tooltipline").attr("x1",e<i.x?e+r+5+2:e-r-5-2).attr("y1",o).attr("x2",e<i.x?e+r+5+2:e-r-5-2).attr("y2",o).call(function(t){t.style("fill","none").style("stroke",s).style("stroke-width",2).style("stroke-dasharray","3,3")}).transition().delay(350).duration(350).ease(t.easeLinear).attr("x2",i.x)}function h(e,o,r,s,i){return function(){var a,l,n=0,c=0,b=0,u=0;o=parseFloat(o),r=parseFloat(r),s=parseFloat(s);var g=t.rgb(t.rgb(i).r+.4*(255-t.rgb(i).r),t.rgb(i).g+.4*(255-t.rgb(i).g),t.rgb(i).b+.4*(255-t.rgb(i).b)),h=t.rgb(t.rgb(i).r+.6*(255-t.rgb(i).r),t.rgb(i).g+.6*(255-t.rgb(i).g),t.rgb(i).b+.6*(255-t.rgb(i).b));y.objs.tooltip.append("circle").attr("class","circle-tooltipcircle").attr("cx",o).attr("cy",r).attr("r",s).call(function(t){t.attr("opacity",0).style("fill","none").style("stroke",i).style("stroke-width",1)}).transition().duration(350).ease(t.easeLinear).attr("r",s+5).call(function(t){t.attr("opacity",1).style("stroke-width",2)}),y.boxPlots||y.violinPlots||p(o,r,s,i);var d=y.objs.tooltip.append("g"),f=d.append("rect").attr("class","circle-tooltipbox"),j=x(e);d.selectAll("dont").data(j).enter().append("text").attr("class","circle-tooltiptext").style("fill","black").text(function(t){return t}),d.each(function(){n=this.getBBox().width>n?this.getBBox().width:n,c=this.getBBox().height>c?this.getBBox().height:c}),d.selectAll("text").attr("x",0).attr("y",function(){return(u+=this.getBBox().height)-this.getBBox().height/2}),f.attr("x",-5).attr("y",-5).attr("height",Math.floor(u+5)-.5).attr("width",n+10).attr("rx",5).attr("ry",5).call(function(t){t.style("fill",h).style("stroke",g).style("stroke-width",2).style("opacity",.95)}),f.each(function(){n=this.getBBox().width>n?this.getBBox().width:n,b=this.getBBox().width>c?this.getBBox().height:c}),o+s+5+10+n<parseFloat(y.width)?(a=o+s+5+10,l=r-(u-(c-5))/2):o-s-(15+n)>0?(a=o-s-(15+n),l=r-(u-(c-5))/2):r+s+u+10+5<parseFloat(y.height)?(a=(a=(a=o-(10+n)/2)>0?a:10)+n<parseFloat(y.width)?a:parseFloat(y.width)-n-10,l=r+s+10):(a=(a=(a=o-(10+n)/2)>0?a:10)+n<parseFloat(y.width)?a:parseFloat(y.width)-n-10,l=r-u-(c-5)),l<0?l=0:l+b>y.height&&(l-=l+b-y.height),d.attr("transform","translate("+a+","+l+")")}}function d(e,o,r,s,i,a){return function(){var l,n,c=0,b=0,u=0,g=0;o=parseFloat(o),r=parseFloat(r),s=parseFloat(s),i=parseFloat(i);var p=t.rgb(t.rgb(a).r+.4*(255-t.rgb(a).r),t.rgb(a).g+.4*(255-t.rgb(a).g),t.rgb(a).b+.4*(255-t.rgb(a).b)),h=t.rgb(t.rgb(a).r+.6*(255-t.rgb(a).r),t.rgb(a).g+.6*(255-t.rgb(a).g),t.rgb(a).b+.6*(255-t.rgb(a).b));y.objs.tooltip.append("rect").attr("class","metrics-tooltipbox").attr("x",o).attr("y",r).attr("width",i).attr("height",s).call(function(t){t.attr("opacity",0).style("fill","none").style("stroke",a).style("stroke-width",1)}).transition().duration(350).ease(t.easeLinear).attr("x",o-5).attr("y",r-5).attr("width",i+10).attr("height",s+10).call(function(t){t.attr("opacity",1).style("stroke-width",2)});var d=y.objs.tooltip.append("g"),f=d.append("rect").attr("class","metrics-tooltipbox"),j=x(e);d.selectAll("dont").data(j).enter().append("text").attr("class","metrics-tooltiptext").style("fill","black").text(function(t){return t}),d.each(function(){c=this.getBBox().width>c?this.getBBox().width:c,b=this.getBBox().height>b?this.getBBox().height:b}),d.selectAll("text").attr("x",0).attr("y",function(){return(g+=this.getBBox().height)-this.getBBox().height/2}),f.attr("x",-5).attr("y",-5).attr("height",Math.floor(g+5)-.5).attr("width",c+10).attr("rx",5).attr("ry",5).call(function(t){t.style("fill",h).style("stroke",p).style("stroke-width",2).style("opacity",.95)}),f.each(function(){c=this.getBBox().width>c?this.getBBox().width:c,u=this.getBBox().width>b?this.getBBox().height:b}),o+i+5+10+c<parseFloat(y.width)?(l=o+i+5+10,n=r+s/2-(g-(b-5))/2):o-i-(15+c)>0?(l=o-(15+c),n=r+s/2-(g-(b-5))/2):r+s+g+10+5<parseFloat(y.height)?(l=(l=(l=o-(10+c)/2)>0?l:10)+c<parseFloat(y.width)?l:parseFloat(y.width)-c-10,n=r+s+10):(l=(l=(l=o-(10+c)/2)>0?l:10)+c<parseFloat(y.width)?l:parseFloat(y.width)-c-10,n=r-g-(b-5)),n<0?n=0:n+u>y.height&&(n-=n+u-y.height),d.attr("transform","translate("+l+" , "+n+")")}}function f(){return function(){y.objs.tooltip.selectAll("circle").remove(),y.objs.tooltip.selectAll("line").remove(),y.objs.tooltip.selectAll("rect").remove(),y.objs.tooltip.selectAll("g").remove()}}function j(t){if(null==t)throw new Error("Co-ordinate of object is null");return t.substring(t.indexOf("(")+1,t.indexOf(")")).split(",")}var y={settings:{},yFormatter:null,yScale:null,xFormatter:null,xScale:null,data:null,groupObjs:{},objs:{},colorFunct:null,margin:{},axisMargin:null,svgWidth:null,svgHeight:null,width:null,height:null,xAxisLabel:null,yAxisLabel:null,yRange:[],xRange:[],selector:null};y.settings={data:null,xName:null,yName:null,selector:null,caption:null,axisLabels:{xAxis:null,yAxis:null},yTicks:1,xTicks:1,axisScale:{xAxis:"ordinal",yAxis:"linear"},chartSize:{width:800,height:400},margin:{top:20,right:50,bottom:20,left:10},axisMargin:25,constrainExtremes:!1,colors:t.scaleOrdinal(t.schemeCategory10)};for(var m in e)y.settings[m]=e[m];y.data=y.settings.data,y.objs={mainDiv:null,innerDiv:null,chartDiv:null,svg:null,g:null,axes:null,xAxis:null,yAxis:null,tooltip:null};var v={};return v.messages={checkNumber:"Value must be a number",checkPositive:"Value must be greater than zero",checkNonNegative:"Value must be greater than or equal to zero",checkLogLinear:"Scale should be either log or linear",checkDistro:"x Axis must be ordinal, y Axis must be log/linear",checkAxis:"Values for axis are unsuitable for the scale you chose"},v.checkNumber=function(t){for(var e=0;e<t.length;e++)if("number"!=typeof t[e]&&isNaN(t[e]))return!1;return!0},v.checkPositive=function(t){for(var e=0;e<t.length;e++)if(t[e]<=0)return!1;return!0},v.checkNonNegative=function(t){for(var e=0;e<t.length;e++)if(t[e]<0)return!1;return!0},v.checkLogLinear=function(t){return"log"===t||"linear"===t},v.checkDistro=function(){return"ordinal"===y.xScale.scale&&v.checkLogLinear(y.yScale.scale)},v.checkAxis=function(){var t={xAxis:null,yAxis:null};return function(){if("ordinal"!==y.xScale.scale){if("linear"!==y.xScale.scale)return"log"===y.xScale.scale?v.checkNumber(y.xRange)?(t.xAxis=!0,v.checkPositive(y.xRange)?void(t.xAxis=!0):void(t.xAxis=!1)):void(t.xAxis=!1):void 0;t.xAxis=v.checkNumber(y.xRange)}else t.xAxis=!0}(),function(){if("ordinal"!==y.yScale.scale){if("linear"!==y.yScale.scale)return"log"===y.yScale.scale?v.checkNumber(y.yRange)?(t.yAxis=!0,v.checkPositive(y.yRange)?void(t.yAxis=!0):void(t.yAxis=!1)):void(t.yAxis=!1):void 0;t.yAxis=v.checkNumber(y.yRange)}else t.yAxis=!0}(),!(!t.xAxis||!t.yAxis)},v.printError=function(t,e,o){if(t(e))return!0;throw y.objs.innerDiv&&y.objs.innerDiv.remove(),new Error(v.messages[o])},y.update=function(){return y.svgWidth=parseInt(y.objs.chartDiv.style("width"),10)-(y.margin.left+y.margin.right),y.svgHeight=parseInt(y.objs.chartDiv.style("height"),10)-(y.margin.top+y.margin.bottom),y.width=y.svgWidth-y.margin.left-y.margin.right,y.height=y.svgHeight-y.margin.top-y.margin.bottom,y.xScale.range([0,y.width]),y.yScale.range([y.height,0]),y.violinPlots&&1==y.violinPlots.options.show&&null!=y.violinPlots.options._yDomainVP&&y.yScale.domain(y.violinPlots.options._yDomainVP).nice().clamp(!0),y.objs.g.select(".x.axis").attr("transform","translate(0,"+y.height+")").call(y.objs.xAxis),y.objs.g.select(".y.axis").call(y.objs.yAxis.tickSizeInner(-y.width)),y.objs.g.select(".x.axis .label").attr("x",y.width/2),y.objs.g.select(".y.axis .label").attr("x",-y.height/2),y},function(){var t,e,o=null,r=null;for(t=0;t<y.data.length;t++)o=y.data[t][y.settings.xName],r=y.data[t][y.settings.yName],e=y.data[t],y.groupObjs.hasOwnProperty(o)?(y.groupObjs[o].values.push(r),y.groupObjs[o].tooltip.push(e)):(y.groupObjs[o]={},y.groupObjs[o].values=[r],y.groupObjs[o].tooltip=[e])}(),y.margin=y.settings.margin,y.axisMargin=y.settings.axisMargin,y.svgWidth=y.settings.chartSize.width+y.axisMargin,y.svgHeight=y.settings.chartSize.height+y.axisMargin,y.width=y.settings.chartSize.width-y.margin.left-y.margin.right,y.height=y.settings.chartSize.height-y.margin.top-y.margin.bottom,y.colorFunct=c(y.settings.colors),y.settings.axisLabels.xAxis||y.settings.axisLabels.yAxis?(y.xAxisLabel=y.settings.axisLabels.xAxis,y.yAxisLabel=y.settings.axisLabels.yAxis):(y.xAxisLabel=y.settings.xName,y.yAxisLabel=y.settings.yName),"log"===y.settings.axisScale.yAxis?(y.yScale=t.scaleLog(),y.yScale.scale=y.settings.axisScale.yAxis,y.yFormatter=u,y.yRange=t.extent(y.data,function(t){return t[y.settings.yName]})):"ordinal"===y.settings.axisScale.yAxis?(y.yScale=t.scaleBand(),y.yScale.scale=y.settings.axisScale.yAxis,y.yRange=y.data.map(function(t){return t[y.settings.yName]}).filter(function(t,e,o){return o.indexOf(t)==e}),y.yRange=g(y.yRange)):"linear"===y.settings.axisScale.yAxis&&(y.yScale=t.scaleLinear(),y.yScale.scale=y.settings.axisScale.yAxis,y.yFormatter=n,y.yRange=t.extent(y.data,function(t){return t[y.settings.yName]})),"log"===y.settings.axisScale.xAxis?(y.xScale=t.scaleLog(),y.xScale.scale=y.settings.axisScale.xAxis,y.xFormatter=u,y.xRange=t.extent(y.data,function(t){return t[y.settings.xName]})):"ordinal"===y.settings.axisScale.xAxis?(y.xScale=t.scaleBand(),y.xScale.scale=y.settings.axisScale.xAxis,y.xRange=Object.keys(y.groupObjs),y.xRange=g(y.xRange)):"linear"===y.settings.axisScale.xAxis&&(y.xScale=t.scaleLinear(),y.xScale.scale=y.settings.axisScale.xAxis,y.xFormatter=n,y.xRange=t.extent(y.data,function(t){return t[y.settings.xName]})),y.yScale.range([y.height,0]).domain(y.yRange),"log"!==y.settings.axisScale.yAxis&&"linear"!==y.settings.axisScale.yAxis||y.yScale.nice().clamp(!0),y.xScale.range([0,y.width]).domain(y.xRange),"log"!==y.settings.axisScale.xAxis&&"linear"!==y.settings.axisScale.xAxis||y.xScale.nice().clamp(!0),y.objs.yAxis=t.axisLeft().scale(y.yScale).tickFormat(y.yFormatter).tickSize(5).tickSizeOuter(0).tickSizeInner(-y.width).ticks(10*y.settings.yTicks),y.objs.xAxis=t.axisBottom().scale(y.xScale).tickFormat(y.xFormatter).tickSize(5).tickSizeOuter(0).ticks(10*y.settings.xTicks),function(){function e(t,e,o){var r=0,s=0,i=null;return"linear"===e?i=t.ticks():"ordinal"===e&&(i=t.domain()),y.objs.svg.selectAll("text.foo").data(i).enter().append("text").text(function(t){return t}).each(function(){r=Math.max(this.getBBox().width+o.tickPadding(),r),s=Math.max(this.getBBox().height,s)}).remove(),{width:r,height:s}}if(y.objs.mainDiv=t.select(y.settings.selector).attr("class","chart-wrapper").style("max-width",y.svgWidth+"px"),y.objs.innerDiv=y.objs.mainDiv.append("div").attr("class","inner-wrapper"),y.objs.innerDiv.append("div").attr("class","outer-box").append("div").attr("class","inner-box"),v.printError(v.checkAxis,"","checkAxis")){y.selector=y.objs.innerDiv.select(".inner-box"),y.objs.chartDiv=y.selector,y.objs.svg=y.objs.chartDiv.append("svg").attr("class","chart-area").attr("width",y.svgWidth+y.axisMargin+y.margin.left).attr("height",y.svgHeight);var o=e(y.yScale,y.settings.axisScale.yAxis,y.objs.yAxis),r=e(y.xScale,y.settings.axisScale.xAxis,y.objs.xAxis);y.objs.g=y.objs.svg.append("g").attr("transform","translate("+(o.width+y.axisMargin+y.margin.left)+","+y.margin.top+")"),y.objs.axes=y.objs.g.append("g").attr("class","axes"),y.objs.axes.yAxis=y.objs.axes.append("g").attr("class","y axis").call(y.objs.yAxis),y.objs.axes.yAxisLabel=y.objs.axes.yAxis.append("text").attr("class","label").attr("transform","rotate(-90)").attr("y",-o.width-y.axisMargin).attr("x",-y.height/2).attr("dy",".71em").attr("fill","black").style("text-anchor","middle").style("font-weight","bold").text(y.yAxisLabel.toUpperCase()),y.objs.axes.xAxis=y.objs.axes.append("g").attr("class","x axis").attr("transform","translate(0,"+y.height+")").call(y.objs.xAxis),y.objs.axes.xAxisLabel=y.objs.axes.xAxis.append("text").attr("class","label").attr("x",y.width/2).attr("y",r.height+y.axisMargin).attr("fill","black").style("text-anchor","middle").style("font-weight","bold").text(y.xAxisLabel.toUpperCase());for(var s in y.groupObjs)y.groupObjs[s].g=y.objs.g.append("g").attr("class","group");y.settings.caption&&(y.objs.caption=y.objs.axes.xAxis.append("text").attr("class","caption").attr("fill","black").attr("x",y.width/2).attr("y",r.height+2*y.axisMargin).style("text-anchor","middle").style("font-weight","bold").text(y.settings.caption),y.height-=y.axisMargin,y.yScale.range([y.height,0]),y.objs.yAxis.scale(y.yScale),y.objs.axes.yAxis.call(y.objs.yAxis),y.objs.axes.xAxis.attr("transform","translate(0,"+y.height+")"));var i;"ordinal"===y.settings.axisScale.xAxis?i=y.xScale.bandwidth():"linear"===y.settings.axisScale.xAxis&&(i=y.width/y.xScale.ticks().length),r.width>=i&&(y.objs.axes.xAxis.selectAll(".tick text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-90)"),y.height-=r.width,y.objs.axes.xAxisLabel.attr("y",r.width+y.axisMargin),y.objs.caption&&y.objs.caption.attr("y",r.width+2*y.axisMargin),y.yScale.range([y.height,0]),y.objs.yAxis.scale(y.yScale),y.objs.axes.yAxis.call(y.objs.yAxis),y.objs.axes.xAxis.attr("transform","translate(0,"+y.height+")")),y.objs.tooltip=y.objs.g.append("g").attr("class","tooltip")}}(),y.renderBoxPlot=function(e){y.boxPlots={};var i={show:!0,showBox:!0,showWhiskers:!0,showMedian:!0,showMean:!1,medianCSize:3.5,meanCSize:3.5,showOutliers:!0,boxWidth:30,lineWidth:null,scatterOutliers:!0,outlierCSize:2.5,extremeCSize:2.5,colors:y.colorFunct};y.boxPlots.options=l(i);for(var n in e)y.boxPlots.options[n]=e[n];var u=y.boxPlots.options;for(var x in y.groupObjs)y.groupObjs[x].boxPlot={},y.groupObjs[x].boxPlot.objs={};if(v.printError(v.checkDistro,"","checkDistro")){!function(){for(var e in y.groupObjs)if(!y.groupObjs[e].boxMetrics){y.groupObjs[e].boxMetrics={};var o=y.groupObjs[e].values.slice();o.sort(t.ascending),y.groupObjs[e].boxMetrics=a(o),y.groupObjs[e].boxMetrics.values=o;var r=y.groupObjs[e].tooltip.slice();r.sort(function(t,e){return t[y.settings.yName]-e[y.settings.yName]}),y.groupObjs[e].boxMetrics.tooltip=r}}();var g=function(){for(var t in y.groupObjs)!function(t){var e,o,r=[],s=[];for(o=0;o<t.boxMetrics.values.length;o++)(e={value:t.boxMetrics.values[o],tooltip:t.boxMetrics.tooltip[o]}).value<t.boxMetrics.lowerInnerFence?e.value<t.boxMetrics.lowerOuterFence?r.push(e):s.push(e):e.value>t.boxMetrics.upperInnerFence&&(e.value>t.boxMetrics.upperOuterFence?r.push(e):s.push(e));t.boxPlot.objs.outliers=s,t.boxPlot.objs.extremes=r}(y.groupObjs[t])}();return y.boxPlots.change=function(t){if(t)for(var e in t)u[e]=t[e];for(var o in y.groupObjs)y.groupObjs[o].boxPlot.objs.g.remove();y.boxPlots.prepareBoxPlot(),y.boxPlots.update()},y.boxPlots.hide=function(t){void 0!==t?(t.show=!1,t.reset&&y.boxPlots.reset()):t={show:!1},y.boxPlots.change(t)},y.boxPlots.prepareBoxPlot=function(){var t,e;if(u.colors?y.boxPlots.color=c(u.colors):y.boxPlots.color=y.colorFunct,0!=u.show){for(t in y.groupObjs)if(e=y.groupObjs[t].boxPlot,e.objs.g=y.groupObjs[t].g.append("g").attr("class","box-plot"),u.showBox&&(e.objs.box=e.objs.g.append("rect").attr("class","box").style("fill",y.boxPlots.color(t)).style("stroke",y.boxPlots.color(t))),u.showMedian&&(e.objs.median={line:null,circle:null},e.objs.median.line=e.objs.g.append("line").attr("class","median"),e.objs.median.circle=e.objs.g.append("circle").attr("class","median").attr("r",u.medianCSize).style("fill",y.boxPlots.color(t))),u.showMean&&(e.objs.mean={line:null,circle:null},e.objs.mean.line=e.objs.g.append("line").attr("class","mean"),e.objs.mean.circle=e.objs.g.append("circle").attr("class","mean").attr("r",u.meanCSize).style("fill",y.boxPlots.color(t))),u.showWhiskers&&(e.objs.upperWhisker={fence:null,line:null},e.objs.lowerWhisker={fence:null,line:null},e.objs.upperWhisker.fence=e.objs.g.append("line").attr("class","upper whisker").style("stroke",y.boxPlots.color(t)),e.objs.upperWhisker.line=e.objs.g.append("line").attr("class","upper whisker").style("stroke",y.boxPlots.color(t)),e.objs.lowerWhisker.fence=e.objs.g.append("line").attr("class","lower whisker").style("stroke",y.boxPlots.color(t)),e.objs.lowerWhisker.line=e.objs.g.append("line").attr("class","lower whisker").style("stroke",y.boxPlots.color(t))),u.showOutliers){e.objs.outliers||g();var o;if(e.objs.outliers.length){var i=e.objs.g.append("g").attr("class","boxplot outliers");for(o in e.objs.outliers)e.objs.outliers[o].point=i.append("circle").attr("class","outlier").attr("r",u.outlierCSize).style("fill",y.boxPlots.color(t))}if(e.objs.extremes.length){var a=e.objs.g.append("g").attr("class","boxplot extremes");for(o in e.objs.extremes)e.objs.extremes[o].point=a.append("circle").attr("class","extreme").attr("r",u.extremeCSize).style("stroke",y.boxPlots.color(t))}}y.violinPlots||s("box",r("box",y.boxPlots.color,y.settings.xName),y.boxPlots.color,y.settings.xName)}},y.boxPlots.reset=function(){y.boxPlots.change(i)},y.boxPlots.show=function(t){void 0!==t?(t.show=!0,t.reset&&y.boxPlots.reset()):t={show:!0},y.boxPlots.change(t)},y.boxPlots.update=function(){var t,e;for(t in y.groupObjs){e=y.groupObjs[t].boxPlot;var r=b(y.xScale,u.boxWidth,t),s=r.right-r.left,i={};for(var a in y.groupObjs[t].boxMetrics)i[a]=null,i[a]=y.yScale(y.groupObjs[t].boxMetrics[a]);var n=l(y.groupObjs[t].boxMetrics);delete n.values,delete n.tooltip;var c,x,g,p;e.objs.box&&(e.objs.box.attr("x",r.left).attr("width",s).attr("y",i.quartile3).attr("rx",1).attr("ry",1).attr("height",-i.quartile3+i.quartile1),c=e.objs.box.attr("x"),x=e.objs.box.attr("y"),g=e.objs.box.attr("height"),s=e.objs.box.attr("width"),p=e.objs.box.style("fill"),e.objs.box.on("mouseover",d(n,c,x,g,s,p)).on("mouseout",f()));var j=null;j=u.lineWidth?b(y.xScale,u.lineWidth,t):r,e.objs.upperWhisker&&(e.objs.upperWhisker.fence.attr("x1",j.left).attr("x2",j.right).attr("y1",i.upperInnerFence).attr("y2",i.upperInnerFence),e.objs.upperWhisker.line.attr("x1",j.middle).attr("x2",j.middle).attr("y1",i.quartile3).attr("y2",i.upperInnerFence),e.objs.lowerWhisker.fence.attr("x1",j.left).attr("x2",j.right).attr("y1",i.lowerInnerFence).attr("y2",i.lowerInnerFence),e.objs.lowerWhisker.line.attr("x1",j.middle).attr("x2",j.middle).attr("y1",i.quartile1).attr("y2",i.lowerInnerFence)),e.objs.median&&(e.objs.median.line.attr("x1",j.left).attr("x2",j.right).attr("y1",i.median).attr("y2",i.median),e.objs.median.circle.attr("cx",j.middle).attr("cy",i.median),e.objs.box&&(e.objs.median.circle.on("mouseover",d(n,c,x,g,s,p)).on("mouseout",f()),e.objs.median.line.on("mouseover",d(n,c,x,g,s,p)).on("mouseout",f()))),e.objs.mean&&(e.objs.mean.line.attr("x1",j.left).attr("x2",j.right).attr("y1",i.mean).attr("y2",i.mean),e.objs.mean.circle.attr("cx",j.middle).attr("cy",i.mean),e.objs.box&&(e.objs.mean.circle.on("mouseover",d(n,c,x,g,s,p)).on("mouseout",f()),e.objs.mean.line.on("mouseover",d(n,c,x,g,s,p)).on("mouseout",f())));var m,v,w,P;if(e.objs.outliers&&u.showOutliers)for(P in e.objs.outliers)e.objs.outliers[P].point.attr("cx",r.middle+o(u.scatterOutliers,s)).attr("cy",y.yScale(e.objs.outliers[P].value)),n=e.objs.outliers[P].tooltip,m=e.objs.outliers[P].point.attr("cx"),v=e.objs.outliers[P].point.attr("cy"),w=e.objs.outliers[P].point.attr("r"),p=e.objs.outliers[P].point.style("fill"),e.objs.outliers[P].point.on("mouseover",h(n,m,v,w,p)).on("mouseout",f());if(e.objs.extremes&&u.showOutliers)for(P in e.objs.extremes)e.objs.extremes[P].point.attr("cx",r.middle+o(u.scatterOutliers,s)).attr("cy",y.yScale(e.objs.extremes[P].value)),n=e.objs.extremes[P].tooltip,m=e.objs.extremes[P].point.attr("cx"),v=e.objs.extremes[P].point.attr("cy"),w=e.objs.extremes[P].point.attr("r"),p=e.objs.extremes[P].point.style("stroke"),e.objs.extremes[P].point.on("mouseover",h(n,m,v,w,p)).on("mouseout",f())}},y.boxPlots.prepareBoxPlot(),t.select(window).on("resize.boxPlot",y.boxPlots.update),y.boxPlots.update(),y}},y.renderViolinPlot=function(e){function o(t){return function(e){return Math.abs(e/=t)<=1?.75*(1-e*e)/t:0}}function i(e,o){return function(r){return t.mean(o,function(t){return e(r-t)})}}function n(e,o){return function(r){return o.map(function(o){return{x:o,y:t.mean(r,function(t){return e(o-t)})}})}}y.violinPlots={};var u={show:!0,showViolinPlot:!0,resolution:100,bandWidth:20,width:50,interpolation:t.curveCardinal,clamp:0,colors:y.colorFunct,_yDomainVP:null};y.violinPlots.options=l(u);for(var x in e)y.violinPlots.options[x]=e[x];var g=y.violinPlots.options;for(var p in y.groupObjs)y.groupObjs[p].violin={},y.groupObjs[p].violin.objs={};if(v.printError(v.checkDistro,"","checkDistro"))return function(){for(var e in y.groupObjs)if(!y.groupObjs[e].boxMetrics){y.groupObjs[e].boxMetrics={};var o=y.groupObjs[e].values.slice();o.sort(t.ascending),y.groupObjs[e].boxMetrics=a(o),y.groupObjs[e].boxMetrics.values=o;var r=y.groupObjs[e].tooltip.slice();r.sort(function(t,e){return t[y.settings.yName]-e[y.settings.yName]}),y.groupObjs[e].boxMetrics.tooltip=r}}(),y.violinPlots.change=function(t){if(t)for(var e in t)g[e]=t[e];for(var o in y.groupObjs)y.groupObjs[o].violin.objs.g.remove();y.violinPlots.prepareViolin(),y.violinPlots.update()},y.violinPlots.hide=function(t){void 0!==t?(t.show=!1,t.reset&&y.violinPlots.reset()):t={show:!1},y.violinPlots.change(t)},y.violinPlots.prepareViolin=function(){var t,e;if(g.colors?y.violinPlots.color=c(g.colors):y.violinPlots.color=y.colorFunct,0!=g.show){for(t in y.groupObjs)(e=y.groupObjs[t].violin).objs.g=y.groupObjs[t].g.append("g").attr("class","violin-plot"),e.objs.left={area:null,line:null,g:e.objs.g.append("g")},e.objs.right={area:null,line:null,g:e.objs.g.append("g")},!1!==g.showViolinPlot&&(e.objs.left.area=e.objs.left.g.append("path").attr("class","area").style("fill",y.violinPlots.color(t)),e.objs.right.area=e.objs.right.g.append("path").attr("class","area").style("fill",y.violinPlots.color(t)),e.objs.left.line=e.objs.left.g.append("path").attr("class","line").style("fill","none").style("stroke",y.violinPlots.color(t)),e.objs.right.line=e.objs.right.g.append("path").attr("class","line").style("fill","none").style("stroke",y.violinPlots.color(t)));s("violin",r("violin",y.violinPlots.color,y.settings.xName),y.violinPlots.color,y.settings.xName)}},y.violinPlots.reset=function(){y.violinPlots.change(u)},y.violinPlots.show=function(t){void 0!==t?(t.show=!0,t.reset&&y.violinPlots.reset()):t={show:!0},y.violinPlots.change(t)},y.violinPlots.update=function(){var e,r;for(e in y.groupObjs){r=y.groupObjs[e].violin;var s=y.yScale.copy();r.kde=n(o(g.bandWidth),s.ticks(g.resolution)),r.kdeData=r.kde(y.groupObjs[e].boxMetrics.values);var a=y.groupObjs[e].boxMetrics.max,l=y.groupObjs[e].boxMetrics.min;if(0==g.clamp||-1==g.clamp){if(a=t.min(r.kdeData.filter(function(t){return t.x>y.groupObjs[e].boxMetrics.max&&0==t.y}),function(t){return t.x}),l=t.max(r.kdeData.filter(function(t){return t.x<y.groupObjs[e].boxMetrics.min&&0==t.y}),function(t){return t.x}),-1==g.clamp){var c=i(o(g.bandWidth),y.groupObjs[e].boxMetrics.values);if(!a){for(var u=c(y.groupObjs[e].boxMetrics.max),x=y.groupObjs[e].boxMetrics.max,p=25;p>0&&0!=u;)u=c(x),x+=1,p-=1;a=x}if(!l){for(var h=c(y.groupObjs[e].boxMetrics.min),d=y.groupObjs[e].boxMetrics.min,p=25;p>0&&0!=h;)h=c(d),d-=1,p-=1;l=d}}g._yDomainVP||(g._yDomainVP=y.yRange.slice(0)),l&&l<g._yDomainVP[0]&&(g._yDomainVP[0]=l),a&&a>g._yDomainVP[1]&&(g._yDomainVP[1]=a)}g.showViolinPlot&&(s=y.yScale.copy(),r.kde=n(o(g.bandWidth),s.ticks(g.resolution)),r.kdeData=r.kde(y.groupObjs[e].boxMetrics.values)),r.kdeData=r.kdeData.filter(function(t){return!l||t.x>=l}).filter(function(t){return!a||t.x<=a})}for(e in y.groupObjs){r=y.groupObjs[e].violin;var f=b(y.xScale,g.width,e),j=(f.right-f.left)/2,m=t.scaleLinear().range([j,0]).domain([0,t.max(r.kdeData,function(t){return t.y})]).clamp(!0),v=t.area().curve(g.interpolation).x(function(t){return s(t.x)}).y0(j).y1(function(t){return m(t.y)}),w=t.line().curve(g.interpolation).x(function(t){return s(t.x)}).y(function(t){return m(t.y)});r.objs.left.area&&(r.objs.left.area.datum(r.kdeData).attr("d",v),r.objs.left.line.datum(r.kdeData).attr("d",w),r.objs.right.area.datum(r.kdeData).attr("d",v),r.objs.right.line.datum(r.kdeData).attr("d",w)),r.objs.left.g.attr("transform","rotate(90,0,0)   translate(0,-"+f.left+")  scale(1,-1)"),r.objs.right.g.attr("transform","rotate(90,0,0)  translate(0,-"+f.right+")")}},y.violinPlots.prepareViolin(),t.select(window).on("resize.violinPlot",y.violinPlots.update),y.violinPlots.update(),y},y.renderBubblePlot=function(e){y.bubblePlots={};var o={show:!0,showBubble:!0,bubbleWidth:30,bubbleVolume:"",colorBy:"",colors:y.colorFunct};y.bubblePlots.options=l(o);for(var i in e)y.bubblePlots.options[i]=e[i];var a=y.bubblePlots.options;for(var n in y.groupObjs)y.groupObjs[n].bubblePlot={},y.groupObjs[n].bubblePlot.objs={};return function(){var t,e,o=null;for(t=0;t<y.data.length;t++){o=y.data[t][y.settings.xName],e=y.data[t];var r={value:y.data[t][y.settings.yName],volume:y.data[t][a.bubbleVolume],color:y.data[t][a.colorBy],tooltip:e};y.groupObjs[o].bubbleValues?y.groupObjs[o].bubbleValues.push(r):y.groupObjs[o].bubbleValues=[r]}}(),y.bubblePlots.change=function(t){if(t)for(var e in t)a[e]=t[e];for(var o in y.groupObjs)y.groupObjs[o].bubblePlot.objs.g.remove();y.bubblePlots.prepareBoxPlot(),y.bubblePlots.update()},y.bubblePlots.hide=function(t){void 0!==t?(t.show=!1,t.reset&&y.bubblePlots.reset()):t={show:!1},y.bubblePlots.change(t)},y.bubblePlots.prepareBubblePlot=function(){var e,o;if(a.colors?y.bubblePlots.color=c(a.colors):y.bubblePlots.color=y.colorFunct,0!=a.show){var i;i="ordinal"===y.settings.axisScale.xAxis&&"ordinal"===y.settings.axisScale.yAxis?[3,.9*Math.min(y.xScale.bandwidth(),y.yScale.bandwidth())/2]:"ordinal"===y.settings.axisScale.xAxis&&"ordinal"!==y.settings.axisScale.yAxis?[3,.9*y.xScale.bandwidth()/2]:"ordinal"!==y.settings.axisScale.xAxis&&"ordinal"===y.settings.axisScale.yAxis?[3,.9*y.yScale.bandwidth()/2]:[3,30];var l=0,n=t.extent(y.data.map(function(t){return+t[a.bubbleVolume]})).map(function(t){return t>0&&(l=Math.floor(Math.log10(t))),l=Math.pow(10,l),t=Math.floor(t/l)*l});n[1]=n[1]+l;var b=t.scaleSqrt().domain(n).range(i);if(v.printError(v.checkNonNegative,n,"checkNonNegative")){for(e in y.groupObjs)if(o=y.groupObjs[e].bubblePlot,o.objs.bubble=[],o.objs.g=y.groupObjs[e].g.append("g").attr("class","bubble-plot"),a.showBubble)for(var u in y.groupObjs[e].bubbleValues){var x=y.groupObjs[e].bubbleValues[u].volume,g=y.groupObjs[e].bubbleValues[u].color;o.objs.bubble?o.objs.bubble.push(o.objs.g.append("circle").attr("class","bubble").attr("r",function(){return b(x)}).style("fill",y.bubblePlots.color(g)).style("opacity",.8)):(o.objs.bubble=[],o.objs.bubble=[o.objs.g.append("circle").attr("class","bubble").attr("r",function(){return b(x)}).style("fill",y.bubblePlots.color(g)).style("opacity",.8)])}s("bubble",r("bubble",y.bubblePlots.color,a.colorBy),y.bubblePlots.color,a.colorBy)}}},y.bubblePlots.reset=function(){y.bubblePlots.change(o)},y.bubblePlots.show=function(t){void 0!==t?(t.show=!0,t.reset&&y.bubblePlots.reset()):t={show:!0},y.bubblePlots.change(t)},y.bubblePlots.update=function(){var t,e;for(t in y.groupObjs){e=y.groupObjs[t].bubblePlot;var o,r;if("ordinal"===y.settings.axisScale.xAxis?o=b(y.xScale,a.bubbleWidth,t).middle:"linear"===y.settings.axisScale.xAxis&&(o=y.xScale(t)),e.objs.bubble)for(var s in y.groupObjs[t].bubbleValues){var i=y.groupObjs[t].bubbleValues[s].value,l=y.groupObjs[t].bubbleValues[s].tooltip;"ordinal"===y.settings.axisScale.yAxis?r=b(y.yScale,a.bubbleWidth,i).middle:"linear"===y.settings.axisScale.yAxis&&(r=y.yScale(i)),e.objs.bubble[s].attr("cx",o).attr("cy",r);var n,c;n=e.objs.bubble[s].attr("r"),c=e.objs.bubble[s].style("fill"),e.objs.bubble[s].on("mouseover",h(l,o,r,n,c)).on("mouseout",f())}}},y.bubblePlots.prepareBubblePlot(),t.select(window).on("resize.bubblePlot",y.bubblePlots.update),y.bubblePlots.update(),y},y},o});