!function(t,e){"use strict";if("object"==typeof exports)module.exports=e(require("d3"),require("crossfilter"));else if("function"==typeof define&&define.amd)define(["d3"],["crossfilter"],function(o,r){return t.a3=e(o,r),t.a3});else if(t.d3&&t.crossfilter)t.a3=e(t.d3,t.crossfilter);else if(console&&console.warn)t.d3?t.crossfilter||console.warn("a3 requires crossfilter to run. Are you missing a reference to crossfilter library?"):console.warn("a3 requires d3 to run.  Are you missing a reference to the d3 library?");else{if(!t.d3)throw"a3 requires d3 to run.  Are you missing a reference to the d3 library?";if(!t.crossfilter)throw"a3 requires crossfilter to run. Are you missing a reference to crossfilter library?"}}(this,function(t,e){"use strict";var o={version:"1.1.0",plot:{}};return o.plot.setUp=function(e){var o={settings:{},yFormatter:null,yScale:null,xFormatter:null,xScale:null,data:null,groupObjs:{},objs:{},colorFunct:null,margin:{},axisMargin:null,svgWidth:null,svgHeight:null,width:null,height:null,xAxisLabel:null,yAxisLabel:null,yRange:[],xRange:[],selector:null};o.settings={data:null,xName:null,yName:null,selector:null,caption:null,axisLabels:{xAxis:null,yAxis:null},yTicks:1,xTicks:1,axisScale:{xAxis:"ordinal",yAxis:"linear"},chartSize:{width:800,height:400},margin:{top:20,right:50,bottom:20,left:10},axisMargin:25,constrainExtremes:!1,colors:t.scaleOrdinal(t.schemeCategory10)};for(var r in e)o.settings[r]=e[r];function s(t,e){return!0!==t||0==e?0:Math.floor(Math.random()*e)-e/2}function i(t,e,r){l(t,e,r);var s={height:o.objs.legend.node().getBBox().height,width:o.objs.legend.node().getBBox().width};return o.objs.legend&&(o.objs.legend.selectAll("g").remove(),o.objs.legend.selectAll("text").remove()),o.objs.legend.remove(),s}function a(t,e,r,s){o.width-=e.width+22,o.xScale.range([0,o.width]),o.objs.xAxis.scale(o.xScale),o.objs.axes.xAxis.call(o.objs.xAxis),o.objs.g.select(".x.axis .label").attr("x",o.width/2),o.objs.g.select(".x.axis .caption").attr("x",o.width/2),o.objs.yAxis.tickSizeInner(-o.width),o.objs.axes.yAxis.call(o.objs.yAxis),l(t,r,s)}function l(t,e,r){o.objs.legend=o.objs.g.append("g").attr("class","legend-wrapper"),o.objs.legend.append("text").attr("class","legend-title").attr("x",o.width+4).attr("y",0).text(r.toUpperCase());var s=o.objs.legend.selectAll(".legend").data(d(e.domain())).enter().append("g").attr("class","legend-point").attr("transform",function(t,e){return"translate("+(o.width+4)+","+(22*e+5)+")"});s.append("rect").attr("class",t+"-legend").attr("width",18).attr("height",18).style("fill",e).style("stroke",e),s.append("text").attr("x",22).attr("y",14).style("fill","black").text(function(t){return t})}function n(e){var o={max:null,upperOuterFence:null,upperInnerFence:null,quartile3:null,median:null,mean:null,quartile1:null,iqr:null,lowerInnerFence:null,lowerOuterFence:null,min:null};o.max=t.max(e),o.quartile3=t.quantile(e,.75),o.median=t.median(e),o.mean=t.mean(e),o.quartile1=t.quantile(e,.25),o.iqr=o.quartile3-o.quartile1,o.min=t.min(e);for(var r=o.quartile1-1.5*o.iqr,s=o.quartile3+1.5*o.iqr,i=0;i<e.length;i++)if(!(e[i]<r))if(!o.lowerInnerFence&&e[i]>=r)o.lowerInnerFence=e[i];else if(e[i]>s){o.upperInnerFence=e[i-1];break}return o.lowerOuterFence=o.quartile1-3*o.iqr,o.upperOuterFence=o.quartile3+3*o.iqr,o.lowerInnerFence||(o.lowerInnerFence=o.min),o.upperInnerFence||(o.upperInnerFence=o.max),o}function c(t){if(null==t||"object"!=typeof t)return t;var e=t.constructor();for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}o.data=o.settings.data,o.objs={mainDiv:null,innerDiv:null,chartDiv:null,svg:null,g:null,axes:null,xAxis:null,yAxis:null,tooltip:null};var b={};function u(e){return e%1!=0?t.format(".2f")(e):t.format(".0f")(e)}function x(e){if("function"==typeof e)return e;if(Array.isArray(e)){var r={},s=0;for(var i in o.groupObjs)r[i]=e[s],s=(s+1)%e.length;return function(t){return r[t]}}return"object"==typeof e?function(t){return e[t]}:t.scaleOrdinal(t.schemeCategory10)}function g(t,e,o){var r={left:null,right:null,middle:null},s=t.bandwidth()*(e/100),i=(t.bandwidth()-s)/2,a=t(o);return r.middle=t.bandwidth()/2+a,r.left=i+a,r.right=r.left+s,r}function p(t){var e=Math.log(t)/Math.log(10)+1e-6;return Math.abs(e-Math.floor(e))<.6?u(t):""}function h(t){for(var e=[],o=Object.keys(t),r=0;r<o.length;r++){var s;s="string"==typeof t[o[r]]?"number"!=typeof parseFloat(t[o[r]])||isNaN(parseFloat(t[o[r]]))||parseFloat(t[o[r]]).toString().length!=t[o[r]].length?t[o[r]]:u(parseFloat(t[o[r]])):"number"==typeof t[o[r]]?u(t[o[r]]):t[o[r]],e.push(o[r].charAt(0).toUpperCase()+o[r].slice(1)+": "+s)}return e}function d(e){var o=!1;for(var r in e){if("number"!=typeof parseFloat(e[r])||isNaN(parseFloat(e[r]))||parseFloat(e[r]).toString().length!=e[r].toString().length){o=!1;break}o=!0}if(o)return e.sort(t.ascending);var s=e.slice().reduce(function(t,e){return t.length>e.length?t:e});for(var r in e){var i=Array(s.length+1).join(" ");e[r]=(i+e[r]).slice(-s.length)}return e.sort(t.ascending),e=e.map(function(t){return t.replace(/(^\s+|\s+$)/g,"")})}function f(e,r,s,i){var a={},l=function(t){if(null==t)throw new Error("Co-ordinate of object is null");return t.substring(t.indexOf("(")+1,t.indexOf(")")).split(",")}(o.objs.axes.xAxis.attr("transform"));a.y=l[1],a.x=0,o.objs.tooltip.append("line").attr("class","circle-tooltipline").attr("x1",e).attr("y1",r<a.y?r+s+5+2:r-s-5-2).attr("x2",e).attr("y2",r<a.y?r+s+5+2:r-s-5-2).call(function(t){t.style("fill","none").style("stroke",i).style("stroke-width",2).style("stroke-dasharray","3,3")}).transition().delay(350).duration(350).ease(t.easeLinear).attr("y2",a.y),o.objs.tooltip.append("line").attr("class","circle-tooltipline").attr("x1",e<a.x?e+s+5+2:e-s-5-2).attr("y1",r).attr("x2",e<a.x?e+s+5+2:e-s-5-2).attr("y2",r).call(function(t){t.style("fill","none").style("stroke",i).style("stroke-width",2).style("stroke-dasharray","3,3")}).transition().delay(350).duration(350).ease(t.easeLinear).attr("x2",a.x)}function j(e,r,s,i,a){return function(){var l,n,c=0,b=0,u=0,x=0;r=parseFloat(r),s=parseFloat(s),i=parseFloat(i);var g=t.rgb(t.rgb(a).r+.4*(255-t.rgb(a).r),t.rgb(a).g+.4*(255-t.rgb(a).g),t.rgb(a).b+.4*(255-t.rgb(a).b)),p=t.rgb(t.rgb(a).r+.6*(255-t.rgb(a).r),t.rgb(a).g+.6*(255-t.rgb(a).g),t.rgb(a).b+.6*(255-t.rgb(a).b));o.objs.tooltip.append("circle").attr("class","circle-tooltipcircle").attr("cx",r).attr("cy",s).attr("r",i).call(function(t){t.attr("opacity",0).style("fill","none").style("stroke",a).style("stroke-width",1)}).transition().duration(350).ease(t.easeLinear).attr("r",i+5).call(function(t){t.attr("opacity",1).style("stroke-width",2)}),o.boxPlots||o.violinPlots||f(r,s,i,a);var d=o.objs.tooltip.append("g"),j=d.append("rect").attr("class","circle-tooltipbox"),y=h(e);d.selectAll("dont").data(y).enter().append("text").attr("class","circle-tooltiptext").style("fill","black").text(function(t){return t}),d.each(function(){c=this.getBBox().width>c?this.getBBox().width:c,b=this.getBBox().height>b?this.getBBox().height:b}),d.selectAll("text").attr("x",0).attr("y",function(){return(x+=this.getBBox().height)-this.getBBox().height/2}),j.attr("x",-5).attr("y",-5).attr("height",Math.floor(x+5)-.5).attr("width",c+10).attr("rx",5).attr("ry",5).call(function(t){t.style("fill",p).style("stroke",g).style("stroke-width",2).style("opacity",.95)}),j.each(function(){c=this.getBBox().width>c?this.getBBox().width:c,u=this.getBBox().width>b?this.getBBox().height:b}),r+i+5+10+c<parseFloat(o.width)?(l=r+i+5+10,n=s-(x-(b-5))/2):r-i-(15+c)>0?(l=r-i-(15+c),n=s-(x-(b-5))/2):s+i+x+10+5<parseFloat(o.height)?(l=(l=(l=r-(10+c)/2)>0?l:10)+c<parseFloat(o.width)?l:parseFloat(o.width)-c-10,n=s+i+10):(l=(l=(l=r-(10+c)/2)>0?l:10)+c<parseFloat(o.width)?l:parseFloat(o.width)-c-10,n=s-x-(b-5)),n<0?n=0:n+u>o.height&&(n-=n+u-o.height),d.attr("transform","translate("+l+","+n+")")}}function y(e,r,s,i,a,l){return function(){var n,c,b=0,u=0,x=0,g=0;r=parseFloat(r),s=parseFloat(s),i=parseFloat(i),a=parseFloat(a);var p=t.rgb(t.rgb(l).r+.4*(255-t.rgb(l).r),t.rgb(l).g+.4*(255-t.rgb(l).g),t.rgb(l).b+.4*(255-t.rgb(l).b)),d=t.rgb(t.rgb(l).r+.6*(255-t.rgb(l).r),t.rgb(l).g+.6*(255-t.rgb(l).g),t.rgb(l).b+.6*(255-t.rgb(l).b));o.objs.tooltip.append("rect").attr("class","metrics-tooltipbox").attr("x",r).attr("y",s).attr("width",a).attr("height",i).call(function(t){t.attr("opacity",0).style("fill","none").style("stroke",l).style("stroke-width",1)}).transition().duration(350).ease(t.easeLinear).attr("x",r-5).attr("y",s-5).attr("width",a+10).attr("height",i+10).call(function(t){t.attr("opacity",1).style("stroke-width",2)});var f=o.objs.tooltip.append("g"),j=f.append("rect").attr("class","metrics-tooltipbox"),y=h(e);f.selectAll("dont").data(y).enter().append("text").attr("class","metrics-tooltiptext").style("fill","black").text(function(t){return t}),f.each(function(){b=this.getBBox().width>b?this.getBBox().width:b,u=this.getBBox().height>u?this.getBBox().height:u}),f.selectAll("text").attr("x",0).attr("y",function(){return(g+=this.getBBox().height)-this.getBBox().height/2}),j.attr("x",-5).attr("y",-5).attr("height",Math.floor(g+5)-.5).attr("width",b+10).attr("rx",5).attr("ry",5).call(function(t){t.style("fill",d).style("stroke",p).style("stroke-width",2).style("opacity",.95)}),j.each(function(){b=this.getBBox().width>b?this.getBBox().width:b,x=this.getBBox().width>u?this.getBBox().height:u}),r+a+5+10+b<parseFloat(o.width)?(n=r+a+5+10,c=s+i/2-(g-(u-5))/2):r-a-(15+b)>0?(n=r-(15+b),c=s+i/2-(g-(u-5))/2):s+i+g+10+5<parseFloat(o.height)?(n=(n=(n=r-(10+b)/2)>0?n:10)+b<parseFloat(o.width)?n:parseFloat(o.width)-b-10,c=s+i+10):(n=(n=(n=r-(10+b)/2)>0?n:10)+b<parseFloat(o.width)?n:parseFloat(o.width)-b-10,c=s-g-(u-5)),c<0?c=0:c+x>o.height&&(c-=c+x-o.height),f.attr("transform","translate("+n+" , "+c+")")}}function m(){return function(){o.objs.tooltip.selectAll("circle").remove(),o.objs.tooltip.selectAll("line").remove(),o.objs.tooltip.selectAll("rect").remove(),o.objs.tooltip.selectAll("g").remove()}}return b.messages={checkNumber:"Value must be a number",checkPositive:"Value must be greater than zero",checkNonNegative:"Value must be greater than or equal to zero",checkLogLinear:"Scale should be either log or linear",checkDistro:"x Axis must be ordinal, y Axis must be log/linear",checkAxis:"Values for axis are unsuitable for the scale you chose"},b.checkNumber=function(t){for(var e=0;e<t.length;e++)if("number"!=typeof t[e]&&isNaN(t[e]))return!1;return!0},b.checkPositive=function(t){for(var e=0;e<t.length;e++)if(t[e]<=0)return!1;return!0},b.checkNonNegative=function(t){for(var e=0;e<t.length;e++)if(t[e]<0)return!1;return!0},b.checkLogLinear=function(t){return"log"===t||"linear"===t},b.checkDistro=function(){return"ordinal"===o.xScale.scale&&b.checkLogLinear(o.yScale.scale)},b.checkAxis=function(){var t={xAxis:null,yAxis:null};return function(){if("ordinal"!==o.xScale.scale){if("linear"!==o.xScale.scale)return"log"===o.xScale.scale?b.checkNumber(o.xRange)?(t.xAxis=!0,b.checkPositive(o.xRange)?void(t.xAxis=!0):void(t.xAxis=!1)):void(t.xAxis=!1):void 0;t.xAxis=b.checkNumber(o.xRange)}else t.xAxis=!0}(),function(){if("ordinal"!==o.yScale.scale){if("linear"!==o.yScale.scale)return"log"===o.yScale.scale?b.checkNumber(o.yRange)?(t.yAxis=!0,b.checkPositive(o.yRange)?void(t.yAxis=!0):void(t.yAxis=!1)):void(t.yAxis=!1):void 0;t.yAxis=b.checkNumber(o.yRange)}else t.yAxis=!0}(),!(!t.xAxis||!t.yAxis)},b.printError=function(t,e,r){if(t(e))return!0;throw o.objs.innerDiv&&o.objs.innerDiv.remove(),new Error(b.messages[r])},o.update=function(){return o.svgWidth=parseInt(o.objs.chartDiv.style("width"),10)-(o.margin.left+o.margin.right),o.svgHeight=parseInt(o.objs.chartDiv.style("height"),10)-(o.margin.top+o.margin.bottom),o.width=o.svgWidth-o.margin.left-o.margin.right,o.height=o.svgHeight-o.margin.top-o.margin.bottom,o.xScale.range([0,o.width]),o.yScale.range([o.height,0]),o.violinPlots&&1==o.violinPlots.options.show&&null!=o.violinPlots.options._yDomainVP&&o.yScale.domain(o.violinPlots.options._yDomainVP).nice().clamp(!0),o.objs.g.select(".x.axis").attr("transform","translate(0,"+o.height+")").call(o.objs.xAxis),o.objs.g.select(".y.axis").call(o.objs.yAxis.tickSizeInner(-o.width)),o.objs.g.select(".x.axis .label").attr("x",o.width/2),o.objs.g.select(".y.axis .label").attr("x",-o.height/2),o},function(){var t,e,r=null,s=null;for(t=0;t<o.data.length;t++)r=o.data[t][o.settings.xName],s=o.data[t][o.settings.yName],e=o.data[t],o.groupObjs.hasOwnProperty(r)?(o.groupObjs[r].values.push(s),o.groupObjs[r].tooltip.push(e)):(o.groupObjs[r]={},o.groupObjs[r].values=[s],o.groupObjs[r].tooltip=[e]);console.log("Chart = "),console.log(o)}(),o.margin=o.settings.margin,o.axisMargin=o.settings.axisMargin,o.svgWidth=o.settings.chartSize.width+o.axisMargin,o.svgHeight=o.settings.chartSize.height+o.axisMargin,o.width=o.settings.chartSize.width-o.margin.left-o.margin.right,o.height=o.settings.chartSize.height-o.margin.top-o.margin.bottom,o.colorFunct=x(o.settings.colors),o.settings.axisLabels.xAxis||o.settings.axisLabels.yAxis?(o.xAxisLabel=o.settings.axisLabels.xAxis,o.yAxisLabel=o.settings.axisLabels.yAxis):(o.xAxisLabel=o.settings.xName,o.yAxisLabel=o.settings.yName),"log"===o.settings.axisScale.yAxis?(o.yScale=t.scaleLog(),o.yScale.scale=o.settings.axisScale.yAxis,o.yFormatter=p,o.yRange=t.extent(o.data,function(t){return t[o.settings.yName]})):"ordinal"===o.settings.axisScale.yAxis?(o.yScale=t.scaleBand(),o.yScale.scale=o.settings.axisScale.yAxis,o.yRange=o.data.map(function(t){return t[o.settings.yName]}).filter(function(t,e,o){return o.indexOf(t)==e}),o.yRange=d(o.yRange)):"linear"===o.settings.axisScale.yAxis&&(o.yScale=t.scaleLinear(),o.yScale.scale=o.settings.axisScale.yAxis,o.yFormatter=u,o.yRange=t.extent(o.data,function(t){return t[o.settings.yName]})),"log"===o.settings.axisScale.xAxis?(o.xScale=t.scaleLog(),o.xScale.scale=o.settings.axisScale.xAxis,o.xFormatter=p,o.xRange=t.extent(o.data,function(t){return t[o.settings.xName]})):"ordinal"===o.settings.axisScale.xAxis?(o.xScale=t.scaleBand(),o.xScale.scale=o.settings.axisScale.xAxis,o.xRange=Object.keys(o.groupObjs),o.xRange=d(o.xRange)):"linear"===o.settings.axisScale.xAxis&&(o.xScale=t.scaleLinear(),o.xScale.scale=o.settings.axisScale.xAxis,o.xFormatter=u,o.xRange=t.extent(o.data,function(t){return t[o.settings.xName]})),console.log("Chart Range = "),console.log(o.yRange),o.yScale.range([o.height,0]).domain(o.yRange),"log"!==o.settings.axisScale.yAxis&&"linear"!==o.settings.axisScale.yAxis||o.yScale.nice().clamp(!0),o.xScale.range([0,o.width]).domain(o.xRange),"log"!==o.settings.axisScale.xAxis&&"linear"!==o.settings.axisScale.xAxis||o.xScale.nice().clamp(!0),o.objs.yAxis=t.axisLeft().scale(o.yScale).tickFormat(o.yFormatter).tickSize(5).tickSizeOuter(0).tickSizeInner(-o.width).ticks(10*o.settings.yTicks),o.objs.xAxis=t.axisBottom().scale(o.xScale).tickFormat(o.xFormatter).tickSize(5).tickSizeOuter(0).ticks(10*o.settings.xTicks),function(){function e(t,e,r){var s=0,i=0,a=null;return"linear"===e?a=t.ticks():"ordinal"===e&&(a=t.domain()),o.objs.svg.selectAll("text.foo").data(a).enter().append("text").text(function(t){return t}).each(function(){s=Math.max(this.getBBox().width+r.tickPadding(),s),i=Math.max(this.getBBox().height,i)}).remove(),{width:s,height:i}}if(o.objs.mainDiv=t.select(o.settings.selector).attr("class","chart-wrapper").style("max-width",o.svgWidth+"px"),o.objs.innerDiv=o.objs.mainDiv.append("div").attr("class","inner-wrapper"),o.objs.innerDiv.append("div").attr("class","outer-box").append("div").attr("class","inner-box"),b.printError(b.checkAxis,"","checkAxis")){o.selector=o.objs.innerDiv.select(".inner-box"),o.objs.chartDiv=o.selector,o.objs.svg=o.objs.chartDiv.append("svg").attr("class","chart-area").attr("width",o.svgWidth+o.axisMargin+o.margin.left).attr("height",o.svgHeight);var r,s=e(o.yScale,o.settings.axisScale.yAxis,o.objs.yAxis),i=e(o.xScale,o.settings.axisScale.xAxis,o.objs.xAxis);o.objs.g=o.objs.svg.append("g").attr("transform","translate("+(s.width+o.axisMargin+o.margin.left)+","+o.margin.top+")"),o.objs.axes=o.objs.g.append("g").attr("class","axes"),o.objs.axes.yAxis=o.objs.axes.append("g").attr("class","y axis").call(o.objs.yAxis),o.objs.axes.yAxisLabel=o.objs.axes.yAxis.append("text").attr("class","label").attr("transform","rotate(-90)").attr("y",-s.width-o.axisMargin).attr("x",-o.height/2).attr("dy",".71em").attr("fill","black").style("text-anchor","middle").style("font-weight","bold").text(o.yAxisLabel.toUpperCase()),o.objs.axes.xAxis=o.objs.axes.append("g").attr("class","x axis").attr("transform","translate(0,"+o.height+")").call(o.objs.xAxis),o.objs.axes.xAxisLabel=o.objs.axes.xAxis.append("text").attr("class","label").attr("x",o.width/2).attr("y",i.height+o.axisMargin).attr("fill","black").style("text-anchor","middle").style("font-weight","bold").text(o.xAxisLabel.toUpperCase());for(var a in o.groupObjs)o.groupObjs[a].g=o.objs.g.append("g").attr("class","group");o.settings.caption&&(o.objs.caption=o.objs.axes.xAxis.append("text").attr("class","caption").attr("fill","black").attr("x",o.width/2).attr("y",i.height+2*o.axisMargin).style("text-anchor","middle").style("font-weight","bold").text(o.settings.caption),o.height-=o.axisMargin,o.yScale.range([o.height,0]),o.objs.yAxis.scale(o.yScale),o.objs.axes.yAxis.call(o.objs.yAxis),o.objs.axes.xAxis.attr("transform","translate(0,"+o.height+")")),"ordinal"===o.settings.axisScale.xAxis?r=o.xScale.bandwidth():"linear"===o.settings.axisScale.xAxis&&(r=o.width/o.xScale.ticks().length),i.width>=r&&(o.objs.axes.xAxis.selectAll(".tick text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-90)"),o.height-=i.width,o.objs.axes.xAxisLabel.attr("y",i.width+o.axisMargin),o.objs.caption&&o.objs.caption.attr("y",i.width+2*o.axisMargin),o.yScale.range([o.height,0]),o.objs.yAxis.scale(o.yScale),o.objs.axes.yAxis.call(o.objs.yAxis),o.objs.axes.xAxis.attr("transform","translate(0,"+o.height+")")),o.objs.tooltip=o.objs.g.append("g").attr("class","tooltip")}}(),o.renderBoxPlot=function(e){o.boxPlots={};var r={show:!0,showBox:!0,showWhiskers:!0,showMedian:!0,showMean:!1,medianCSize:3.5,meanCSize:3.5,showOutliers:!0,boxWidth:30,lineWidth:null,scatterOutliers:!0,outlierCSize:2.5,extremeCSize:2.5,colors:o.colorFunct};o.boxPlots.options=c(r);for(var l in e)o.boxPlots.options[l]=e[l];var u=o.boxPlots.options;for(var p in o.groupObjs)o.groupObjs[p].boxPlot={},o.groupObjs[p].boxPlot.objs={};if(b.printError(b.checkDistro,"","checkDistro")){!function(){for(var e in o.groupObjs)if(!o.groupObjs[e].boxMetrics){o.groupObjs[e].boxMetrics={};var r=o.groupObjs[e].values.slice();r.sort(t.ascending),o.groupObjs[e].boxMetrics=n(r),o.groupObjs[e].boxMetrics.values=r;var s=o.groupObjs[e].tooltip.slice();s.sort(function(t,e){return t[o.settings.yName]-e[o.settings.yName]}),o.groupObjs[e].boxMetrics.tooltip=s}}();var h=function(){function t(t){var e,o,r=[],s=[];for(o=0;o<t.boxMetrics.values.length;o++)(e={value:t.boxMetrics.values[o],tooltip:t.boxMetrics.tooltip[o]}).value<t.boxMetrics.lowerInnerFence?e.value<t.boxMetrics.lowerOuterFence?r.push(e):s.push(e):e.value>t.boxMetrics.upperInnerFence&&(e.value>t.boxMetrics.upperOuterFence?r.push(e):s.push(e));t.boxPlot.objs.outliers=s,t.boxPlot.objs.extremes=r}for(var e in o.groupObjs)t(o.groupObjs[e])}();return o.boxPlots.change=function(t){if(t)for(var e in t)u[e]=t[e];for(var r in o.groupObjs)o.groupObjs[r].boxPlot.objs.g.remove();o.boxPlots.prepareBoxPlot(),o.boxPlots.update()},o.boxPlots.hide=function(t){void 0!==t?(t.show=!1,t.reset&&o.boxPlots.reset()):t={show:!1},o.boxPlots.change(t)},o.boxPlots.prepareBoxPlot=function(){var t,e;if(u.colors?o.boxPlots.color=x(u.colors):o.boxPlots.color=o.colorFunct,0!=u.show){for(t in o.groupObjs)if((e=o.groupObjs[t].boxPlot).objs.g=o.groupObjs[t].g.append("g").attr("class","box-plot"),u.showBox&&(e.objs.box=e.objs.g.append("rect").attr("class","box").style("fill",o.boxPlots.color(t)).style("stroke",o.boxPlots.color(t))),u.showMedian&&(e.objs.median={line:null,circle:null},e.objs.median.line=e.objs.g.append("line").attr("class","median"),e.objs.median.circle=e.objs.g.append("circle").attr("class","median").attr("r",u.medianCSize).style("fill",o.boxPlots.color(t))),u.showMean&&(e.objs.mean={line:null,circle:null},e.objs.mean.line=e.objs.g.append("line").attr("class","mean"),e.objs.mean.circle=e.objs.g.append("circle").attr("class","mean").attr("r",u.meanCSize).style("fill",o.boxPlots.color(t))),u.showWhiskers&&(e.objs.upperWhisker={fence:null,line:null},e.objs.lowerWhisker={fence:null,line:null},e.objs.upperWhisker.fence=e.objs.g.append("line").attr("class","upper whisker").style("stroke",o.boxPlots.color(t)),e.objs.upperWhisker.line=e.objs.g.append("line").attr("class","upper whisker").style("stroke",o.boxPlots.color(t)),e.objs.lowerWhisker.fence=e.objs.g.append("line").attr("class","lower whisker").style("stroke",o.boxPlots.color(t)),e.objs.lowerWhisker.line=e.objs.g.append("line").attr("class","lower whisker").style("stroke",o.boxPlots.color(t))),u.showOutliers){var r;if(e.objs.outliers||h(),e.objs.outliers.length){var s=e.objs.g.append("g").attr("class","boxplot outliers");for(r in e.objs.outliers)e.objs.outliers[r].point=s.append("circle").attr("class","outlier").attr("r",u.outlierCSize).style("fill",o.boxPlots.color(t))}if(e.objs.extremes.length){var l=e.objs.g.append("g").attr("class","boxplot extremes");for(r in e.objs.extremes)e.objs.extremes[r].point=l.append("circle").attr("class","extreme").attr("r",u.extremeCSize).style("stroke",o.boxPlots.color(t))}}if(!o.violinPlots)a("box",i("box",o.boxPlots.color,o.settings.xName),o.boxPlots.color,o.settings.xName)}},o.boxPlots.reset=function(){o.boxPlots.change(r)},o.boxPlots.show=function(t){void 0!==t?(t.show=!0,t.reset&&o.boxPlots.reset()):t={show:!0},o.boxPlots.change(t)},o.boxPlots.update=function(){var t,e;for(t in o.groupObjs){e=o.groupObjs[t].boxPlot;var r=g(o.xScale,u.boxWidth,t),i=r.right-r.left,a={};for(var l in o.groupObjs[t].boxMetrics)a[l]=null,a[l]=o.yScale(o.groupObjs[t].boxMetrics[l]);var n,b,x,p,h=c(o.groupObjs[t].boxMetrics);delete h.values,delete h.tooltip,e.objs.box&&(e.objs.box.attr("x",r.left).attr("width",i).attr("y",a.quartile3).attr("rx",1).attr("ry",1).attr("height",-a.quartile3+a.quartile1),n=e.objs.box.attr("x"),b=e.objs.box.attr("y"),x=e.objs.box.attr("height"),i=e.objs.box.attr("width"),p=e.objs.box.style("fill"),e.objs.box.on("mouseover",y(h,n,b,x,i,p)).on("mouseout",m()));var d,f,v,w,P=null;if(P=u.lineWidth?g(o.xScale,u.lineWidth,t):r,e.objs.upperWhisker&&(e.objs.upperWhisker.fence.attr("x1",P.left).attr("x2",P.right).attr("y1",a.upperInnerFence).attr("y2",a.upperInnerFence),e.objs.upperWhisker.line.attr("x1",P.middle).attr("x2",P.middle).attr("y1",a.quartile3).attr("y2",a.upperInnerFence),e.objs.lowerWhisker.fence.attr("x1",P.left).attr("x2",P.right).attr("y1",a.lowerInnerFence).attr("y2",a.lowerInnerFence),e.objs.lowerWhisker.line.attr("x1",P.middle).attr("x2",P.middle).attr("y1",a.quartile1).attr("y2",a.lowerInnerFence)),e.objs.median&&(e.objs.median.line.attr("x1",P.left).attr("x2",P.right).attr("y1",a.median).attr("y2",a.median),e.objs.median.circle.attr("cx",P.middle).attr("cy",a.median),e.objs.box&&(e.objs.median.circle.on("mouseover",y(h,n,b,x,i,p)).on("mouseout",m()),e.objs.median.line.on("mouseover",y(h,n,b,x,i,p)).on("mouseout",m()))),e.objs.mean&&(e.objs.mean.line.attr("x1",P.left).attr("x2",P.right).attr("y1",a.mean).attr("y2",a.mean),e.objs.mean.circle.attr("cx",P.middle).attr("cy",a.mean),e.objs.box&&(e.objs.mean.circle.on("mouseover",y(h,n,b,x,i,p)).on("mouseout",m()),e.objs.mean.line.on("mouseover",y(h,n,b,x,i,p)).on("mouseout",m()))),e.objs.outliers&&u.showOutliers)for(w in e.objs.outliers)e.objs.outliers[w].point.attr("cx",r.middle+s(u.scatterOutliers,i)).attr("cy",o.yScale(e.objs.outliers[w].value)),h=e.objs.outliers[w].tooltip,d=e.objs.outliers[w].point.attr("cx"),f=e.objs.outliers[w].point.attr("cy"),v=e.objs.outliers[w].point.attr("r"),p=e.objs.outliers[w].point.style("fill"),e.objs.outliers[w].point.on("mouseover",j(h,d,f,v,p)).on("mouseout",m());if(e.objs.extremes&&u.showOutliers)for(w in e.objs.extremes)e.objs.extremes[w].point.attr("cx",r.middle+s(u.scatterOutliers,i)).attr("cy",o.yScale(e.objs.extremes[w].value)),h=e.objs.extremes[w].tooltip,d=e.objs.extremes[w].point.attr("cx"),f=e.objs.extremes[w].point.attr("cy"),v=e.objs.extremes[w].point.attr("r"),p=e.objs.extremes[w].point.style("stroke"),e.objs.extremes[w].point.on("mouseover",j(h,d,f,v,p)).on("mouseout",m())}},o.boxPlots.prepareBoxPlot(),t.select(window).on("resize.boxPlot",o.boxPlots.update),o.boxPlots.update(),o}},o.renderViolinPlot=function(e){o.violinPlots={};var r={show:!0,showViolinPlot:!0,resolution:100,bandWidth:20,width:50,interpolation:t.curveCardinal,clamp:0,colors:o.colorFunct,_yDomainVP:null};o.violinPlots.options=c(r);for(var s in e)o.violinPlots.options[s]=e[s];var l=o.violinPlots.options;for(var u in o.groupObjs)o.groupObjs[u].violin={},o.groupObjs[u].violin.objs={};if(b.printError(b.checkDistro,"","checkDistro"))return function(){for(var e in o.groupObjs)if(!o.groupObjs[e].boxMetrics){o.groupObjs[e].boxMetrics={};var r=o.groupObjs[e].values.slice();r.sort(t.ascending),o.groupObjs[e].boxMetrics=n(r),o.groupObjs[e].boxMetrics.values=r;var s=o.groupObjs[e].tooltip.slice();s.sort(function(t,e){return t[o.settings.yName]-e[o.settings.yName]}),o.groupObjs[e].boxMetrics.tooltip=s}}(),o.violinPlots.change=function(t){if(t)for(var e in t)l[e]=t[e];for(var r in o.groupObjs)o.groupObjs[r].violin.objs.g.remove();o.violinPlots.prepareViolin(),o.violinPlots.update()},o.violinPlots.hide=function(t){void 0!==t?(t.show=!1,t.reset&&o.violinPlots.reset()):t={show:!1},o.violinPlots.change(t)},o.violinPlots.prepareViolin=function(){var t,e;if(l.colors?o.violinPlots.color=x(l.colors):o.violinPlots.color=o.colorFunct,0!=l.show){for(t in o.groupObjs)(e=o.groupObjs[t].violin).objs.g=o.groupObjs[t].g.append("g").attr("class","violin-plot"),e.objs.left={area:null,line:null,g:e.objs.g.append("g")},e.objs.right={area:null,line:null,g:e.objs.g.append("g")},!1!==l.showViolinPlot&&(e.objs.left.area=e.objs.left.g.append("path").attr("class","area").style("fill",o.violinPlots.color(t)),e.objs.right.area=e.objs.right.g.append("path").attr("class","area").style("fill",o.violinPlots.color(t)),e.objs.left.line=e.objs.left.g.append("path").attr("class","line").style("fill","none").style("stroke",o.violinPlots.color(t)),e.objs.right.line=e.objs.right.g.append("path").attr("class","line").style("fill","none").style("stroke",o.violinPlots.color(t)));a("violin",i("violin",o.violinPlots.color,o.settings.xName),o.violinPlots.color,o.settings.xName)}},o.violinPlots.reset=function(){o.violinPlots.change(r)},o.violinPlots.show=function(t){void 0!==t?(t.show=!0,t.reset&&o.violinPlots.reset()):t={show:!0},o.violinPlots.change(t)},o.violinPlots.update=function(){var e,r;for(e in o.groupObjs){r=o.groupObjs[e].violin;var s=o.yScale.copy();r.kde=d(p(l.bandWidth),s.ticks(l.resolution)),r.kdeData=r.kde(o.groupObjs[e].boxMetrics.values);var i=o.groupObjs[e].boxMetrics.max,a=o.groupObjs[e].boxMetrics.min;if(0==l.clamp||-1==l.clamp){if(i=t.min(r.kdeData.filter(function(t){return t.x>o.groupObjs[e].boxMetrics.max&&0==t.y}),function(t){return t.x}),a=t.max(r.kdeData.filter(function(t){return t.x<o.groupObjs[e].boxMetrics.min&&0==t.y}),function(t){return t.x}),-1==l.clamp){var n=h(p(l.bandWidth),o.groupObjs[e].boxMetrics.values);if(!i){for(var c=n(o.groupObjs[e].boxMetrics.max),b=o.groupObjs[e].boxMetrics.max,u=25;u>0&&0!=c;)c=n(b),b+=1,u-=1;i=b}if(!a){var x=n(o.groupObjs[e].boxMetrics.min),f=o.groupObjs[e].boxMetrics.min;for(u=25;u>0&&0!=x;)x=n(f),f-=1,u-=1;a=f}}l._yDomainVP||(l._yDomainVP=o.yRange.slice(0)),a&&a<l._yDomainVP[0]&&(l._yDomainVP[0]=a),i&&i>l._yDomainVP[1]&&(l._yDomainVP[1]=i)}l.showViolinPlot&&(s=o.yScale.copy(),r.kde=d(p(l.bandWidth),s.ticks(l.resolution)),r.kdeData=r.kde(o.groupObjs[e].boxMetrics.values)),r.kdeData=r.kdeData.filter(function(t){return!a||t.x>=a}).filter(function(t){return!i||t.x<=i})}for(e in o.groupObjs){r=o.groupObjs[e].violin;var j=g(o.xScale,l.width,e),y=(j.right-j.left)/2,m=t.scaleLinear().range([y,0]).domain([0,t.max(r.kdeData,function(t){return t.y})]).clamp(!0),v=t.area().curve(l.interpolation).x(function(t){return s(t.x)}).y0(y).y1(function(t){return m(t.y)}),w=t.line().curve(l.interpolation).x(function(t){return s(t.x)}).y(function(t){return m(t.y)});r.objs.left.area&&(r.objs.left.area.datum(r.kdeData).attr("d",v),r.objs.left.line.datum(r.kdeData).attr("d",w),r.objs.right.area.datum(r.kdeData).attr("d",v),r.objs.right.line.datum(r.kdeData).attr("d",w)),r.objs.left.g.attr("transform","rotate(90,0,0)   translate(0,-"+j.left+")  scale(1,-1)"),r.objs.right.g.attr("transform","rotate(90,0,0)  translate(0,-"+j.right+")")}},o.violinPlots.prepareViolin(),t.select(window).on("resize.violinPlot",o.violinPlots.update),o.violinPlots.update(),o;function p(t){return function(e){return Math.abs(e/=t)<=1?.75*(1-e*e)/t:0}}function h(e,o){return function(r){return t.mean(o,function(t){return e(r-t)})}}function d(e,o){return function(r){return o.map(function(o){return{x:o,y:t.mean(r,function(t){return e(o-t)})}})}}},o.renderBubblePlot=function(e){o.bubblePlots={};var r={show:!0,showBubble:!0,bubbleWidth:30,bubbleVolume:"",colorBy:"",colors:o.colorFunct};o.bubblePlots.options=c(r);for(var s in e)o.bubblePlots.options[s]=e[s];var l=o.bubblePlots.options;for(var n in o.groupObjs)o.groupObjs[n].bubblePlot={},o.groupObjs[n].bubblePlot.objs={};return function(){var t,e,r=null;for(t=0;t<o.data.length;t++){r=o.data[t][o.settings.xName],e=o.data[t];var s={value:o.data[t][o.settings.yName],volume:o.data[t][l.bubbleVolume],color:o.data[t][l.colorBy],tooltip:e};o.groupObjs[r].bubbleValues?o.groupObjs[r].bubbleValues.push(s):o.groupObjs[r].bubbleValues=[s]}}(),o.bubblePlots.change=function(t){if(t)for(var e in t)l[e]=t[e];for(var r in o.groupObjs)o.groupObjs[r].bubblePlot.objs.g.remove();o.bubblePlots.prepareBoxPlot(),o.bubblePlots.update()},o.bubblePlots.hide=function(t){void 0!==t?(t.show=!1,t.reset&&o.bubblePlots.reset()):t={show:!1},o.bubblePlots.change(t)},o.bubblePlots.prepareBubblePlot=function(){var e,r;if(l.colors?o.bubblePlots.color=x(l.colors):o.bubblePlots.color=o.colorFunct,0!=l.show){var s;s="ordinal"===o.settings.axisScale.xAxis&&"ordinal"===o.settings.axisScale.yAxis?[3,.9*Math.min(o.xScale.bandwidth(),o.yScale.bandwidth())/2]:"ordinal"===o.settings.axisScale.xAxis&&"ordinal"!==o.settings.axisScale.yAxis?[3,.9*o.xScale.bandwidth()/2]:"ordinal"!==o.settings.axisScale.xAxis&&"ordinal"===o.settings.axisScale.yAxis?[3,.9*o.yScale.bandwidth()/2]:[3,30];var n=0,c=t.extent(o.data.map(function(t){return+t[l.bubbleVolume]})).map(function(t){return t>0&&(n=Math.floor(Math.log10(t))),n=Math.pow(10,n),t=Math.floor(t/n)*n});c[1]=c[1]+n;var u=t.scaleSqrt().domain(c).range(s);if(b.printError(b.checkNonNegative,c,"checkNonNegative")){for(e in o.groupObjs)if((r=o.groupObjs[e].bubblePlot).objs.bubble=[],r.objs.g=o.groupObjs[e].g.append("g").attr("class","bubble-plot"),l.showBubble)for(var g in o.groupObjs[e].bubbleValues){var p=o.groupObjs[e].bubbleValues[g].volume,h=o.groupObjs[e].bubbleValues[g].color;r.objs.bubble?r.objs.bubble.push(r.objs.g.append("circle").attr("class","bubble").attr("r",function(){return u(p)}).style("fill",o.bubblePlots.color(h)).style("opacity",.8)):(r.objs.bubble=[],r.objs.bubble=[r.objs.g.append("circle").attr("class","bubble").attr("r",function(){return u(p)}).style("fill",o.bubblePlots.color(h)).style("opacity",.8)])}a("bubble",i("bubble",o.bubblePlots.color,l.colorBy),o.bubblePlots.color,l.colorBy)}}},o.bubblePlots.reset=function(){o.bubblePlots.change(r)},o.bubblePlots.show=function(t){void 0!==t?(t.show=!0,t.reset&&o.bubblePlots.reset()):t={show:!0},o.bubblePlots.change(t)},o.bubblePlots.update=function(){var t,e;for(t in o.groupObjs){var r,s;if(e=o.groupObjs[t].bubblePlot,"ordinal"===o.settings.axisScale.xAxis)r=g(o.xScale,l.bubbleWidth,t).middle;else"linear"===o.settings.axisScale.xAxis&&(r=o.xScale(t));if(e.objs.bubble)for(var i in o.groupObjs[t].bubbleValues){var a,n,c=o.groupObjs[t].bubbleValues[i].value,b=o.groupObjs[t].bubbleValues[i].tooltip;if("ordinal"===o.settings.axisScale.yAxis)s=g(o.yScale,l.bubbleWidth,c).middle;else"linear"===o.settings.axisScale.yAxis&&(s=o.yScale(c));e.objs.bubble[i].attr("cx",r).attr("cy",s),a=e.objs.bubble[i].attr("r"),n=e.objs.bubble[i].style("fill"),e.objs.bubble[i].on("mouseover",j(b,r,s,a,n)).on("mouseout",m())}}},o.bubblePlots.prepareBubblePlot(),t.select(window).on("resize.bubblePlot",o.bubblePlots.update),o.bubblePlots.update(),o},o},o});